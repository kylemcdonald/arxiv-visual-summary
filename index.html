<html>
<head>
<script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
<style>
* {
    font-family: sans-serif;
}
img {
    height: 128px;
    padding: 4px;
}
</style>
</head>
<body>
<h1><a href="#">All</a></h1>
<div id='content'></div>
<script>
function getHash() { return window.location.hash.substr(1); }
function updatePage() {
    $('#content').empty();
    var hash = getHash();
    console.log('Getting metadata.json');
    $.get('metadata.json', function (mres) {
        if(hash == '') {
            renderIndex(mres);
        } else {
            var dir = mres[hash];
            $.get('image_lists/' + dir + '.json', function (res) {
                renderDir(dir, res);
            })
        }
    })
}
function renderIndex(metadata) {
    console.log('Rendering index.');
    var i = 0;
    metadata.forEach(function (filename) {
        $('#content').append('<h2><a href="#' + i + '">' + filename + '</a><h2/>');
        i++;
    })
}
function renderDir(dir, filenames) {
    console.log('Rendering dir.');
    filenames.forEach(function (filename) {
        var url = 'images/' + dir + '/' + filename;
        var article_id = filename.split('/').reverse()[0].split('_')[0];
        var article_url = 'http://arxiv.org/abs/' + article_id;
        $('#content').append('<a href="' + article_url + '" title="' + article_id + '"><img src="' + url + '"/></a>');
    })
}

$(function() {
    window.onhashchange = updatePage;
    updatePage();
})
</script>
</body>
</html>